<%= content_tag :div, id: dom_id(exercise_instance), data: { controller: "repetitions", sgid: exercise_instance.to_sgid_param }, class: "exercise-instance border-bottom m-1 px-2" do %>

  <div class="exercise-instance-name">
    <p class="py-2"><%= exercise_instance.exercise.name %></p>
    <%= link_to workout_block_exercise_instance_path(exercise_instance.block.workout, exercise_instance.block, exercise_instance), method: :get, data: { controller: "turbo" } do %>
      <i class="bi bi-info-circle emoji-info"></i>
    <% end %>
    
  </div>
  
  <div class="exercise-quantities">

    <div class="emoji quantity-toggle" data-repetitions-target="toggle" data-action="click->repetitions#updateQuantity" data-balloon-length="medium" aria-label="Press this button to switch between time and repetitions" data-balloon-pos="up-left"><%= exercise_instance.tabata ? "⏱" : "🔁" %></div>

    <% if exercise_instance.tabata %>
      <div class="exercise-quantity">
        <p class="py-2 mx-2"><%= exercise_instance.time %>s </p>
        <div class="exercise-instance-quantities">
          <%= link_to "🔼", "#", data: { action: "click->repetitions#more", kind: "time", increment: 10 }, format: :turbo_stream %>
          <%= link_to "🔽", "#", data: { action: "click->repetitions#less", kind: "time", increment: 10 }, format: :turbo_stream %>
        </div>
      </div>
    <% else %>
      <div class="exercise-quantity">
        <p class="py-2 mx-2"><%= exercise_instance.repetitions %>x</p>
        <div class="exercise-instance-quantities">
          <%= link_to "🔼", "#", data: { action: "click->repetitions#more", kind: "repetitions", increment: 2 }, format: :turbo_stream %>
          <%= link_to "🔽", "#", data: { action: "click->repetitions#less", kind: "repetitions", increment: 2 }, format: :turbo_stream %>
        </div>
      </div>
    <% end %>

  </div>
  
  <div class="exercise-instance-actions">
    <div class="handle handle-exercise-instance">
      <i class="bi bi-grip-horizontal"></i>
    </div>
    <%= button_to workout_block_exercise_instance_path(exercise_instance.block.workout, exercise_instance.block, exercise_instance), method: :delete, data: { target: "meta.published" }, form: { data: { turbo_confirm: "Are you sure?" } }, class: "btn-styling hidden" do %>
    <span class="emoji">🗑</span> 
    <% end %>
  </div>

<% end %>