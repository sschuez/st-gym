<%= simple_form_for [@workout, @block, @exercise_instance] do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

  <div data-controller="refresh-list">
    <%= form_with url: new_workout_block_exercise_instance_path(@workout, @block, @exercise_instance), method: :get, html: { class: 'mb-3', data: { refresh_list_target: 'form' } }, data: { turbo: :false } do |f| %>
      <%= f.text_field :query,
                       class: "form-control",
                       placeholder: 'Type an exercise name..',
                       value: params[:query],
                       data: {
                        refresh_list_target: 'searchInput',
                        action: "keyup->refresh-list#update"
                      } %>
    <% end %>
    
  <fieldset class="form-group check_boxes optional exercise_instance_exercises my-3">
    
    <div data-refresh-list-target="list">
      <% @exercises.each do |exercise| %>
        <%# <legend class="col-form-label pt-0">Tags</legend> %>
        
        <input type="hidden" name="exercise_instance[exercise_id][]" value="">
        <div class="tag-item">
          <input class="form-check-input check_boxes optional tag-selector" type="checkbox" value="<%= exercise.id %>" name="exercise_instance[exercise_id][]" id="exercise_instance_exercise_id_<%= exercise.id %>">
          <label class="form-check-label collection_check_boxes" for="exercise_instance_exercise_id_<%= exercise.id %>"><%= exercise.name %></label>
        </div>
      <% end %>
    </div>
  
  </div>


  </fieldset>


  <%#= f.association :exercise,
    collection: Exercise.order(name: :asc),
    legend_tag: false,
    as: :check_boxes,
    input_html: { class: "tag-selector" },
    item_wrapper_class: 'tag-item' %>

  <div class="form-actions">
    <%= f.submit "Add exercise", class: "btn btn-primary", data: { action: "type=submit click->modal#disconnect" } %>
  </div>
<% end %>
